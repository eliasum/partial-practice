/*2025.05.20 18:40 IMM*/

// –ü—Ä–æ–≤–µ—Ä–∏–º —Ç–µ—Ä—è—é—Ç—Å—è –ª–∏ –≤—ã–∑–æ–≤—ã
// –í –®–∞–≥–µ 3, –≥–¥–µ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–∑–æ–≤–æ–≤, –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–º–µ–Ω–Ω–æ —Ç–∞–∫:
// –§—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è.
// –ü–æ—Ç–æ–º, –µ—Å–ª–∏ —Å–Ω–æ–≤–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —Ç–æ—Ç –∂–µ –∫–æ–¥, –æ–Ω–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ—Ç –≤—Ä–µ–º—è —Ç–æ—Ä–º–æ–∑–∞ (ms –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥).
// –ß—Ç–æ–±—ã —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –¥–∞–≤–∞–π—Ç–µ –¥–æ–±–∞–≤–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã–∑–æ–≤–æ–≤ –æ–±—ë—Ä—Ç–∫–∏ –∏ –ø–æ—Å—á–∏—Ç–∞–µ–º, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è.

// "—Ç–æ—Ä–º–æ–∑—è—â–∞—è" —Ñ—É–Ω–∫—Ü–∏—è-–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä
function throttle(func, ms) {
  // üîí –§–ª–∞–≥, –≤–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ –¥–µ–∫–æ—Ä–∏—Ä—É–µ–º–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –≤—ã–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ ms –º—Å
  let isThrottled = false;

  // –æ–±—ë—Ä–Ω—É—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è
  return function (...args) {
    // –ï—Å–ª–∏ —Ñ–ª–∞–≥ –≤–∫–ª—é—á—ë–Ω ‚Äî –∑–Ω–∞—á–∏—Ç, –ø—Ä–æ—à–ª–æ —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ –≤—Ä–µ–º–µ–Ω–∏
    if (isThrottled) {
      // ‚ùå –ü—Ä–æ—Å—Ç–æ –≤—ã—Ö–æ–¥–∏–º ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
      return;
    }

    // ‚úÖ –ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ –∏–ª–∏ –ø–æ—Å–ª–µ –ø–∞—É–∑—ã ‚Äî –∑–∞–ø—É—Å–∫–∞–µ–º –¥–µ–∫–æ—Ä–∏—Ä—É–µ–º—É—é —Ñ—É–Ω–∫—Ü–∏—é
    func.apply(this, args);

    // ‚õî –°—Ç–∞–≤–∏–º "—Ç–æ—Ä–º–æ–∑" ‚Äî –±–ª–æ–∫–∏—Ä—É–µ–º –¥–∞–ª—å–Ω–µ–π—à–∏–µ –≤—ã–∑–æ–≤—ã
    isThrottled = true;

    // ‚è≥ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä: —á–µ—Ä–µ–∑ ms –º—Å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
    setTimeout(() => {
      isThrottled = false; // üîì –¢–µ–ø–µ—Ä—å —Å–Ω–æ–≤–∞ –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å
    }, ms);
  };
}

let callCount = 0; // —Å—á—ë—Ç—á–∏–∫ –≤—ã–∑–æ–≤–æ–≤

function log(a) {
  callCount++; // —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫
  console.log(a);
}

let throttledLog = throttle(log, 1000);

throttledLog(1); // ‚úÖ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –≤—ã–≤–µ–¥–µ—Ç 1
throttledLog(2); // ‚ùå –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
throttledLog(3); // ‚ùå –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è

setTimeout(() => throttledLog(4), 1100); // ‚úÖ –≤—ã–≤–µ–¥–µ—Ç 4 (—á–µ—Ä–µ–∑ 1100 –º—Å)

setTimeout(() => {
  console.log(`–§—É–Ω–∫—Ü–∏—è –±—ã–ª–∞ –≤—ã–∑–≤–∞–Ω–∞ ${callCount} —Ä–∞–∑(–∞)`); // –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤
}, 1500); // –≤—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã

// üß™ –ß—Ç–æ –º—ã –æ–∂–∏–¥–∞–µ–º:
// throttledLog(1) ‚Äî —Å—Ä–∞–∑—É –≤—ã–∑–æ–≤–µ—Ç log –∏ —É–≤–µ–ª–∏—á–∏—Ç callCount –Ω–∞ 1.
// throttledLog(2) –∏ throttledLog(3) ‚Äî –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è (–ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ—Ç 1000 –º—Å).
// –ß–µ—Ä–µ–∑ 1100 –º—Å throttledLog(4) ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è.
// –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ, –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–æ:

// –§—É–Ω–∫—Ü–∏—è –±—ã–ª–∞ –≤—ã–∑–≤–∞–Ω–∞ 2 —Ä–∞–∑(–∞)
// üìò –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –¥–≤–∞ —Ä–∞–∑–∞:
// –§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–≤–∞–∂–¥—ã ‚Äî –æ–¥–∏–Ω —Ä–∞–∑ –≤ –Ω–∞—á–∞–ª–µ (–¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞ 1), –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –ø–æ—Å–ª–µ 1100 –º—Å (–¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞ 4).

// 2 –∏ 3 –±—É–¥—É—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤–æ –≤—Ä–µ–º—è –ø–∞—É–∑—ã.

// üëâ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ ‚Äî –∑–∞–ø–æ–º–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–∑–æ–≤ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –µ–≥–æ –ø–æ—Å–ª–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.